<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Network - Fsh PT</title>
    <meta property="og:title" content="Network - Fsh PT">
    <meta name="twitter:title" content="Network - Fsh PT">
    <meta name="description" content="Fsh PT, an alternative user and application api ui.">
    <meta property="og:description" content="Fsh PT, an alternative user and application api ui.">
    <meta name="twitter:description" content="Fsh PT, an alternative user and application api ui.">
    <!-- ------- -->
    <meta charset="UTF-8">
    <meta name="robots" content="index, follow">
    <meta property="og:locale" content="en">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="https://fsh.plus/favicon.ico" type="image/vnd.microsoft.icon">
    <meta property="og:image" content="https://fsh.plus/favicon.ico">
    <meta property="og:image:alt" content="Fsh logo">
    <meta name="twitter:image" content="https://fsh.plus/favicon.ico">
    <meta name="theme-color" content="#a89c9b">
    <!-- ------- -->
    <link rel="stylesheet" href="https://fsh.plus/media/style.css">
    <script src="https://account.fsh.plus/script.js"></script>
    <!-- ------- -->
    <link rel="stylesheet" href="/media/style.css">
    <script src="/media/script.js"></script>
    <style>
      #alloc {
        display: flex;
        gap: 15px;
        flex-direction: column;
      }
      #alloc > div {
        display: flex;
        align-items: center;
        margin: 0px 10px;
        padding: 10px;
        border-radius: 0.5rem;
        background-color: var(--bg-2);
      }
      #alloc > div > span {
        flex: 1;
        display: flex;
        flex-direction: column;
      }
      textarea {
        resize: none;
      }
    </style>
  </head>
  <body>
    <a id="Bback"><button>Back</button></a>
    <main>
      <div id="alloc"></div>
      <script>
        const params = new URLSearchParams(location.search);
        document.getElementById('Bback').href = '/user/server?id='+params.get('id');
        function getAlloc() {
          PT(`servers/${params.get('id')}/network/allocations`, (a)=>{
            a = a.data;
            document.getElementById('alloc').innerHTML = a.map(p => {p=p.attributes;return `<div>
  <span>
    <span>IP</span>
    <span>${p.ip_alias || p.ip}</span>
  </span>
  <span>
    <span>Port</span>
    <span>${p.port}</span>
  </span>
  <span>
    <textarea placeholder="Notes" onchange="note('${p.id}', this)">${p.notes || ''}</textarea>
  </span>
  <span style="gap:10px;flex-direction:row;justify-content:flex-end;">
    ${p.is_default ? '<span>Primary</span>' : '<button onclick="explode(`'+p.id+'`)">Delete</button><button onclick="primary(`'+p.id+'`)">Make Primary</button>'}
  </span>
</div>`}).join('')
          })
        }
        getAlloc();
        function note(id, that) {
          PT(`servers/${params.get('id')}/network/allocations/${id}`, ()=>{getAlloc()}, 'POST', JSON.stringify({notes: that.value}))
        }
        function primary(id) {
          PT(`servers/${params.get('id')}/network/allocations/${id}/primary`, ()=>{getAlloc()}, 'POST')
        }
        function explode(id) {
          PT(`servers/${params.get('id')}/network/allocations/${id}`, ()=>{getAlloc()}, 'DELETE')
        }
      </script>
    </main>
  </body>
</html>