<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Network view - Fsh Pterodactyl Panel</title>
    <!-- Boiler plate------ -->
    <link rel="icon" href="https://fsh.plus/fsh.png" type="image/png">
    <meta name="description" content="A pterodactyl panel replacement. View activity of a server (login required).">
    <!-- ------- -->
    <link rel="stylesheet" href="https://fsh.plus/media/style.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta property="og:image" content="https://fsh.plus/fsh.png"/>
    <meta name="theme-color" content="#a89c9b">
    <!-- ------------------ -->
    <link rel="stylesheet" href="/media/style.css">
    <link rel="stylesheet" href="/media/user.css">
    <script src="/media/script.js"></script>
  </head>
  <body>
    <a id="Bback"><button>Back</button></a>
    <main>
      <div id="logs"></div>
      <script>
        const params = new URLSearchParams(location.search);
        document.getElementById('Bback').href = '/user/server?id='+params.get('id');
        PT(`servers/${params.get('id')}`, function(s){
          s = s.attributes;
          PT(`servers/${s.uuid}/activity?sort=-timestamp&include[]=actor&page=${(params.get('page')??'1')}`, function(l){
            fetch('/media/activity.json')
              .then(act=>act.json())
              .then(act=>{
                document.getElementById('logs').innerHTML = l.data.map(p => {
                  p = p.attributes;
                  if (p.relationships.actor.attributes === null) {
                    p.relationships.actor.attributes = {
                      username: 'System',
                      image: '/media/system.svg',
                      is_api: false
                    }
                  };
                  return `<div>
  <span>
    <img src="${p.relationships.actor.attributes.image}">
    <span>
      <label>${p.relationships.actor.attributes.username}</label>
      ${p.is_api ? '<label class="badge">API</label>' : ''}
      <br>
      <label class="subtext">${p.ip}</label>
    </span>
  </span>
  <span>
    <label>${p.event}</label>
    <label>${ActivityText(p.event, p.properties, p.has_additional_metadata, act)}</label>
  </span>
</div>`;
/*{
  "timestamp": "2024-08-28T20:43:17+02:00"
}*/
                }).join('')
              })
          })
        })
      </script>
    </main>
  </body>
</html>